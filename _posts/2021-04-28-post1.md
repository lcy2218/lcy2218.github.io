---
layout: post
title:  PPPOE下的chap模式抓包分析
date: 2021-04-28 23:17 +0900
category: routing-theory
---
<!-- TOC -->

- [0x0 抓包分析](#0x0-抓包分析)
- [0x1 补充](#0x1-补充)

<!-- /TOC -->
## 0x0 抓包分析
- PPPOE协议分为2个阶段
![](/images/20210428-1-2.png)

- 其中会话阶段(PPP协议又分三步)
![](/images/20210428-1-3.png)
- 发现阶段抓包
![](/images/20210428-1-1.png)
- 会话阶段抓包
- 由于技术问题，只能分析出NCP报文
![](/images/20210428-1-4.png)
![](/images/20210428-1-5.png)

[详情请见华为PPPpap和chap双向认证配置与抓包与基本ACL配置](https://blog.csdn.net/qq_43153465/article/details/96474561)
- 里面有详细的抓包分析


## 0x1 补充
1. 广域网用来干什么？
    - 连接两个局域网，并非用来上外网
2. PPP具有几种认证方式？
    - PAP**明文**传输   两次握手。安全性不高
    - chap**不发送密码**   应用了MD5算法相同 三次握手。安全性更高
3. PPP协议的过程？
    - 先LCP
      - 以太网最大为**1518**
      - 是否认证以及使用那种认证协议(LCP、NCP)   -----------  认证 - > 被认证方 -----双向认证 PPPOE为单项
      - 协议域压缩，一次传更多数据
      - **魔术数** : 随机数，检测链路连通性，用来检测环路4

    - 认证阶段
       - PAP**明文**传输   两次握手。安全性不高
       - chap**不发送密码**   应用了MD5算法相同 三次握手。安全性更高

    - 再NCP
      - 协商网络层协议IP协议？和分配IP？

4. MSTP？
    - 提供以太网协议
    - 电信 -> 网线 -> 光猫 -> 光纤 -> 光猫 -> 网线 -> 内网路由器